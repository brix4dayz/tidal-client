function map(){$.getJSON(TidePull.SERVER+"/locations?state="+STATE,function(e){var l=new google.maps.Map(document.getElementById("map"),{zoom:7,center:e.coordinates,streetViewControl:!1})
TidePull.coordinates={}
var i=null
for(var t in e.locations)i=e.locations[t].name,TidePull.coordinates[i]={id:e.locations[t].stationId,position:{lat:e.locations[t].lat,lng:e.locations[t].lng}},TidePull.markers[i]=new google.maps.Marker({position:TidePull.coordinates[i].position,map:l,title:i,animation:google.maps.Animation.DROP})
for(var i in TidePull.coordinates)google.maps.event.addListener(TidePull.markers[i],"click",function(e){return function(){TidePull.selectedKey!==e&&null!==TidePull.selectedKey&&TidePull.markers[TidePull.selectedKey].setAnimation(null),null===TidePull.markers[e].animation?(TidePull.selectedKey=e,TidePull.markers[e].setAnimation(google.maps.Animation.BOUNCE),document.getElementById("portSelection").innerHTML="<h3>You have selected: "+e+"</h3>"):(TidePull.selectedKey=null,TidePull.markers[e].setAnimation(null),document.getElementById("portSelection").innerHTML="<h3>Choose port by selecting a map pin:</h3>")}}(i))
l.checkResize()})}var TidePull={}
!function(){function e(e){var l=document.createElement("link")
l.setAttribute("href",e),l.setAttribute("rel","stylesheet"),l.setAttribute("type","text/css"),document.head.appendChild(l)}function l(){var e=!1
return function(l){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(l)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(l.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e}window.TidePull.mobile=l(),window.TidePull.appendStyle=e}(),TidePull.SERVER="//45.33.68.196:80",TidePull.mobile?(TidePull.appendStyle("https://rawgithub.com/brix4dayz/tidal-client/master/client/tides.mobile.min.css"),$("#tideApp").append('      <div class="container" id="app">        <div class="container" id="portSelection">          <p>Choose a port by selecting a map pin:</p>        </div>        <div id="map"></div>      <div id="plotter"><canvas width="300" height="250" id="tideCanvas"></canvas></div>      <div class="container" id="selectdate">      <div class="row" id="selectors">        <p class="btn btn-info btn-sm" id="oneDay">Tides for one Day</p>        <p class="btn btn-info btn-sm" id="multDay">Tides for Multiple Days</p>        <ul class="pull-right" id="daters">          <p id="promptA"> Date: <input type="click" id="datepickerA"></p>          <p id="promptB"> Start Date: <input type="click" id="datepickerB"></p>          <p id="promptC"> End  Date:  <input type="click" id="datepickerC"></p>        </ul>      </div>      <p class="btn btn-sm" id="getTides">Get Tides</p>      <p class="btn btn-info btn-sm" id="returnBtn">Select New Location</p>      <p class="copyright">TidePull © Wren Apps, 2016</p>      </div>      <p id="alerts"></p>      </div>'),document.body.innerHTML+="<p>Mobile Mode!</p>"):(TidePull.appendStyle("https://rawgithub.com/brix4dayz/tidal-client/master/client/tides.min.css"),$("#tideApp").append('      <div class="container" id="app">        <div class="container" id="portSelection">          <h3>Choose a port by selecting a map pin:</h3>        </div>        <div id="map"></div>  	  <div id="plotter"><canvas width="540" height="400" id="tideCanvas"></canvas></div>  	  <div class="container" id="selectdate">  		<div class="row" id="selectors">  			<p class="btn btn-info btn-sm" id="oneDay">Tides for one Day</p>  			<p class="btn btn-info btn-sm" id="multDay">Tides for Multiple Days</p>  			<ul class="pull-right" id="daters">  			  <p id="promptA"> Date: <input type="click" id="datepickerA"></p>  			  <p id="promptB"> Start Date: <input type="click" id="datepickerB"></p>  			  <p id="promptC"> End  Date:  <input type="click" id="datepickerC"></p>  			</ul>  		</div>  		<p class="btn btn-sm" id="getTides">Get Tides</p>  		<p class="btn btn-info btn-sm" id="returnBtn">Select New Location</p>  		<p class="copyright">TidePull © Wren Apps, 2016</p>  	  </div>  	  <p id="alerts"></p>      </div>')),TidePull.coordinates=null,TidePull.markers={},TidePull.selectedKey=null,TidePull.requestCache={},TidePull.randomKey=function(e){var l=Object.keys(e)
return l[l.length*Math.random()<<0]},TidePull.CACHE_MAX=10,TidePull.options=null,TidePull.tideData=null,TidePull.PLOT_TIME=1,TidePull.first=!0,TidePull.canvas=document.getElementById("tideCanvas"),TidePull.context=TidePull.canvas.getContext("2d"),TidePull.stop=!1,TidePull.requestTides=function(){if(TidePull.context.clearRect(0,0,TidePull.clearWidth,TidePull.clearHeight),TidePull.context.fillStyle="#ffffff",TidePull.context.fillRect(0,0,TidePull.clearWidth,TidePull.clearHeight),TidePull.context.fillStyle="#000000",TidePull.context.font="18px Sans Serif",TidePull.context.textAlign="center",TidePull.context.fillText("Loading...",.5*TidePull.chartHeight,.5*TidePull.chartWidth),!TidePull.requestCache[TidePull.options.location+TidePull.options.beginDate+TidePull.options.endDate]){for(;Object.keys(TidePull.requestCache).length>=TidePull.CACHE_MAX;)console.log("Removing a cached request..."),delete TidePull.requestCache[TidePull.randomKey(TidePull.requestCache)]
TidePull.requestCache[TidePull.options.location+TidePull.options.beginDate+TidePull.options.endDate]=$.ajax({type:"POST",url:TidePull.SERVER+"/tides",contentType:"application/json",crossDomain:!0,data:JSON.stringify(TidePull.options),dataType:"json"}).promise()}TidePull.requestCache[TidePull.options.location+TidePull.options.beginDate+TidePull.options.endDate].done(function(e,l,i){var t=JSON.parse(i.responseText)
TidePull.tideData=t["soapenv:Envelope"]["soapenv:Body"][0].PredictionsAndMetadata[0].data[0].item,TidePull.first=!0,TidePull.stop=!1,TidePull.getCanvas()}),TidePull.requestCache[TidePull.options.location+TidePull.options.beginDate+TidePull.options.endDate].fail(function(e){console.log("ERROR:",e)})},Date.prototype.yyyymmdd=function(){var e=this.getFullYear().toString(),l=(this.getMonth()+1).toString(),i=this.getDate().toString()
return e+(l[1]?l:"0"+l[0])+(i[1]?i:"0"+i[0])},Date.prototype.noaaDate=function(){var e=this.getHours().toString(),l=this.getMinutes().toString()
return this.yyyymmdd()+" "+(e[1]?e:"0"+e[0])+":"+(l[1]?l:"0"+l[0])},TidePull.isMultipleDays=!1,$("#plotter").hide(),$("#returnBtn").hide(),$("#oneDay").on("click",function(){$("#multDay").toggle(300),$("#promptA").toggle(300),TidePull.isMultipleDays=!1}),$("#multDay").on("click",function(){$("#oneDay").toggle(300),$("#promptB").toggle(300),$("#promptC").toggle(300),TidePull.isMultipleDays=!0}),$("#promptA").hide(),$("#promptB").hide(),$("#promptC").hide(),TidePull.alertArray=["Please select a valid date range no greater than 7 days.","Please select a begin date and an end date.","Please choose a date.","Please select a location from the map and try again."],TidePull.alerts=document.getElementById("alerts"),TidePull.alerts.innerHTML="",$("#getTides").on("click",function(){if(null!==TidePull.selectedKey){TidePull.options={location:TidePull.selectedKey,id:TidePull.coordinates[TidePull.selectedKey].id}
var e=!1
if(TidePull.isMultipleDays){if(null!==$("#datepickerB").datepicker("getDate")&&null!==$("#datepickerC").datepicker("getDate")){TidePull.options.beginDate=$("#datepickerB").datepicker("getDate").noaaDate(),TidePull.options.endDate=$("#datepickerC").datepicker("getDate"),TidePull.options.endDate.setHours(23),TidePull.options.endDate.setMinutes(59),TidePull.options.endDate=TidePull.options.endDate.noaaDate()
var l=parseInt(TidePull.options.beginDate.slice(6,8)),i=parseInt(TidePull.options.endDate.slice(6,8)),t=parseInt(TidePull.options.beginDate.slice(4,6)),a=parseInt(TidePull.options.endDate.slice(4,6))
i>l&&7>=i-l&&a==t?e=!0:a-1==t&&6>=30-l+i?e=!0:TidePull.alerts.innerHTML=TidePull.alertArray[0]}else TidePull.alerts.innerHTML=TidePull.alertArray[1]
TidePull.options.interval="06"}else null!==$("#datepickerA").datepicker("getDate")?(TidePull.options.beginDate=$("#datepickerA").datepicker("getDate").noaaDate(),TidePull.options.endDate=$("#datepickerA").datepicker("getDate"),TidePull.options.endDate.setHours(23),TidePull.options.endDate.setMinutes(59),TidePull.options.endDate=TidePull.options.endDate.noaaDate(),TidePull.options.interval="06",e=!0):TidePull.alerts.innerHTML=TidePull.alertArray[2]
e&&(TidePull.alerts.innerHTML="",TidePull.requestTides(),$("#map").hide(),$("#plotter").show(),$("#returnBtn").show(300))}else TidePull.alerts.innerHTML=TidePull.alertArray[3]}),$("#returnBtn").on("click",function(){$("#map").show(),$("#plotter").hide(),$("#returnBtn").hide(300)}),$(function(){$("#datepickerA").datepicker()}),$(function(){$("#datepickerB").datepicker()}),$(function(){$("#datepickerC").datepicker()}),TidePull.mobile?(TidePull.chartHeight=225,TidePull.chartWidth=280,TidePull.labelFont1=12,TidePull.labelFont2=8,TidePull.timeFont=7):(TidePull.chartHeight=365,TidePull.chartWidth=490,TidePull.labelFont1=17,TidePull.labelFont2=14,TidePull.timeFont=12),TidePull.leftMarg=.0714*TidePull.chartWidth,TidePull.topMarg=TidePull.chartHeight/18,TidePull.clearHeight=TidePull.chartHeight+TidePull.topMarg,TidePull.clearWidth=TidePull.chartWidth+TidePull.leftMarg,function(){for(var e=0,l=["ms","moz","webkit","o",""],i=0;i<l.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[l[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[l[i]+"CancelAnimationFrame"]||window[l[i]+"CancelRequestAnimationFrame"]
window.requestAnimationFrame||(window.requestAnimationFrame=function(l,i){var t=(new Date).getTime(),a=Math.max(0,16-(t-e)),n=window.setTimeout(function(){l(t+a)},a)
return e=t+a,n}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),function(){function e(){var e=Date.now()
t=(e-(i||e))/1e3,window.TidePull.totalTime=window.TidePull.totalTime+t,i=e}function l(){t=0,window.TidePull.totalTime=0,i=null}var i=null,t=0
window.TidePull.totalTime=0,window.TidePull.updateDeltaTime=e,window.TidePull.resetTime=l}(),TidePull.getCanvas=function(){TidePull.first&&(TidePull.first=!1,TidePull.resetTime()),TidePull.updateDeltaTime(),TidePull.stop?(TidePull.tideData=null,TidePull.options=null):(requestAnimationFrame(TidePull.getCanvas),TidePull.getMax(TidePull.context,TidePull.options,TidePull.tideData))},TidePull.getMax=function(e,l,t){var a=.5,n=-.25
for(i in t)t[i].pred>a&&(a=Math.round(4*t[i].pred)/4+.25),t[i].pred<n&&(n=Math.round(4*t[i].pred)/4-.25)
TidePull.drawAxis(e,l,t,a,n)},TidePull.drawAxis=function(e,l,i,t,a){var n=(t-a)/.25
e.clearRect(0,0,TidePull.clearWidth,TidePull.clearHeight)
for(var d=0;n>d;d++)d%2==0?e.fillStyle="#e8f8ff":e.fillStyle="#fbfdfb",e.fillRect(TidePull.leftMarg+1,d*TidePull.chartHeight/n+TidePull.topMarg,TidePull.chartWidth,TidePull.chartHeight/n)
var o=TidePull.chartHeight*t/(.25*n)+TidePull.topMarg
e.beginPath(),e.moveTo(TidePull.leftMarg,TidePull.topMarg),e.lineTo(TidePull.leftMarg,TidePull.chartHeight+TidePull.topMarg),e.moveTo(TidePull.leftMarg,o),e.lineTo(TidePull.chartWidth+TidePull.leftMarg,o),e.lineWidth=2,e.strokeStyle="#092643",e.stroke(),TidePull.plotData(e,l,i,TidePull.chartHeight,TidePull.chartWidth,o,n,t,a)},TidePull.plotData=function(e,l,i,t,a,n,d,o,r){console.log("Plotting.")
var u=TidePull.totalTime/TidePull.PLOT_TIME
u>=1&&(u=1,TidePull.stop=!0,console.log("Should stop."))
var s=u*i.length,c=i.length
e.strokeStyle="black",e.lineWidth=1,e.beginPath(),e.moveTo(TidePull.leftMarg+1,n-4*i[0].pred*t/d),j=0,e.fillStyle="#a0abb6"
for(var p=0;s>p;p++)e.lineTo(a/c*j+TidePull.leftMarg+1,n-4*i[p].pred*t/d),e.stroke(),e.fillRect(a/c*j+TidePull.leftMarg+1,n-4*i[p].pred*t/d,1,4*i[p].pred*t/d-1),j++
TidePull.labelAxis(e,l,i,o,r,t,d,n,a)},TidePull.labelAxis=function(e,l,i,t,a,n,d,o,r){e.fillStyle="#092643",e.font=TidePull.labelFont1+"px Sans Serif",e.fillText("Feet",1.8*TidePull.leftMarg,2.5*TidePull.topMarg),e.font=TidePull.labelFont2+"px Sans Serif",e.textAlign="right",e.strokeStyle="black"
for(var u=0;t>=u;u+=.25)e.fillText(u,TidePull.leftMarg-8,o-4*u*n/d+.2*TidePull.topMarg),e.beginPath(),e.moveTo(TidePull.leftMarg,o-4*u*n/d),e.lineTo(TidePull.leftMarg+.1*TidePull.leftMarg,o-4*u*n/d),e.stroke()
for(var s=a;0>s;s+=.25)e.fillText(s,TidePull.leftMarg-8,o-4*s*n/d),e.beginPath(),e.moveTo(TidePull.leftMarg,o-4*s*n/d),e.lineTo(TidePull.leftMarg+.1*TidePull.leftMarg,o-4*s*n/d),e.stroke()
TidePull.timeAxis(e,l,r,o,i,n)},TidePull.timeAxis=function(e,l,i,t,a,n){if(240==a.length){e.font=TidePull.timeFont+"px Sans Serif",e.strokeStyle="#092643",e.fillStyle="#092643",e.textAlign="center"
for(var d=1;12>d;d++)e.beginPath(),e.moveTo(TidePull.leftMarg+d*i/12,t),e.lineTo(TidePull.leftMarg+.32*TidePull.leftMarg+d*i/12,t+.6*TidePull.topMarg),e.stroke(),e.closePath(),e.beginPath(),e.arc(TidePull.leftMarg+d*i/12,t,3,0,2*Math.PI,!0),e.closePath(),e.fill(),6>d?e.fillText(2*d+"AM",1.6*TidePull.leftMarg+d*i/12,t+1.2*TidePull.topMarg):6==d?e.fillText(2*d+"PM",1.6*TidePull.leftMarg+d*i/12,t+1.2*TidePull.topMarg):e.fillText(d%6*2+"PM",1.6*TidePull.leftMarg+d*i/12,t+1.2*TidePull.topMarg)}else{e.font=TidePull.timeFont+"px Sans Serif",e.fillStyle="#092643"
var o=a.length/240
e.textAlign="center"
for(var r=0;o>r;r+=.5)e.beginPath(),e.moveTo(TidePull.leftMarg+r*i/o,t),e.lineTo(TidePull.leftMarg+.2*TidePull.leftMarg+r*i/o,t+.6*TidePull.topMarg),e.stroke(),e.closePath(),e.beginPath(),e.arc(TidePull.leftMarg+r*i/o,t,3,0,2*Math.PI,!0),e.closePath(),e.fill(),r%1==0?e.fillText("12AM",1.5*TidePull.leftMarg+r*i/o,t+1.2*TidePull.topMarg):e.fillText("Noon",1.5*TidePull.leftMarg+r*i/o,t+1.2*TidePull.topMarg)}},$("body").append('  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBpN0l_qaCwhVFOKjFIHDuEgtlOkrlFixQ&signed_in=true&callback=map">  </script>')
